{"version":3,"sources":["webpack:///./src/App.vue?2f6a","webpack:///./src/App.vue","webpack:///src/App.vue","webpack:///src/components/common/QR.vue","webpack:///./src/components/common/QR.vue?6c52","webpack:///./src/components/common/QR.vue","webpack:///src/components/common/SendMessage.vue","webpack:///./src/components/common/SendMessage.vue?d35e","webpack:///./src/components/common/SendMessage.vue","webpack:///src/components/page/Login.vue","webpack:///./src/components/page/Login.vue?cd39","webpack:///./src/components/page/Login.vue","webpack:///./src/router/index.js","webpack:///./src/main.js"],"names":["selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","src_App","__webpack_require__","normalizeComponent","name","ssrContext","QR","data","qrUrl","qrStage","qrRequestMsg","qrTimestamp","timerQR","methods","login","_this","_axios_0_19_0_axios_default","a","get","then","res","console","debug","checkQRTimer","catch","err","qrError","message","retry","msg","checkQRTimerClose","log","checkQR","_this2","qr_time","code","wxcode","wechat_error_code","setInterval","clearInterval","created","beforeDestroy","common_QR","_vm","staticClass","directives","rawName","value","expression","element-loading-text","element-loading-spinner","element-loading-background","_v","_s","type","on","click","justify","span","body-style","padding","src","_e","components_common_QR","QR_normalizeComponent","isEmpty","str","trim","String","prototype","replace","SendMessage","username","send","$message","body","post","common_SendMessage","staticStyle","margin","placeholder","model","callback","$$v","autosize","minRows","LoginState","Login","components","SendMessage_normalizeComponent","loginState","timerLogin","showQR","checkLoginTimer","loginCheck","state","checkLoginTimerClose","error","logout","retryLoginCheck","page_Login","components_page_Login","Login_normalizeComponent","Vue","use","Router","router","routes","path","redirect","component","$axios","axios","config","productionTip","ElementUI","el","App","template"],"mappings":"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","file":"static/js/app.a73cf5477511c56ace59.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-0e232033\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0e232033\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0e232033\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <router-view/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'App'\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","<template>\n  <div class=\"qr-root\">\n    <div class=\"qr-loading\"\n         v-if=\"qrStage === 0\"\n         v-loading=\"qrStage === 0\"\n         element-loading-text=\"正在请求微信登录二维码\"\n         element-loading-spinner=\"el-icon-loading\"\n         element-loading-background=\"rgba(0, 0, 0, 0.8)\"></div>\n\n    <div class=\"qr-error\"\n         v-else-if=\"qrStage === 1\">\n      <p class=\"text\">{{qrRequestMsg}}</p>\n      <ElButton type=\"primary\"\n                @click=\"retry\">重试</ElButton>\n    </div>\n\n    <div class=\"qr\"\n         v-else>\n      <ElRow type=\"flex\"\n             justify=\"center\">\n        <ElCol :span=\"5\">\n          <ElCard :body-style=\"{ padding : '0px'}\">\n            <img class=\"image\"\n                 :src=\"qrUrl\" />\n          </ElCard>\n\n          <p v-if=\"qrStage === 2\">请扫描二维码登录</p>\n          <div v-else-if=\"qrStage === 3\">\n            <p>二维码失效</p>\n            <ElButton type=\"primary\"\n                      @click=\"retry\">刷新</ElButton>\n          </div>\n          <div v-else-if=\"qrStage === 4\">\n            <p>请在APP上点击登陆</p>\n          </div>\n          <div v-else-if=\"qrStage === 5\">\n            <p>登陆超时</p>\n            <ElButton type=\"primary\"\n                      @click=\"retry\">刷新</ElButton>\n          </div>\n          <div v-else-if=\"qrStage === 6\">\n            <p>登陆成功</p>\n          </div>\n        </ElCol>\n      </ElRow>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n  data () {\n    return {\n      qrUrl: '/api/qr',\n      // 0 请求发送 1 请求错误 2 请求正常返回，已经获取到二维码 3 二维码失效 4 二维码被扫 5 二维码被扫超时 6 登陆成功\n      qrStage: 0,\n      // 请求信息\n      qrRequestMsg: '请求错误',\n      qrTimestamp: 0,\n      timerQR: null,\n    }\n  },\n  methods: {\n    login () {\n      // 请求登陆\n      axios.get('/api/login')\n        .then(res => {\n          console.debug(res)\n          this.checkQRTimer()\n        })\n        .catch(err => {\n          this.qrError(err.message)\n        })\n    },\n    retry () {\n      this.qrStage = 0\n      this.login()\n    },\n    qrError (msg) {\n      this.qrRequestMsg = msg\n      this.qrStage = 1\n      this.checkQRTimerClose()\n      console.log('获取QR错误：' + msg)\n    },\n    checkQR () {\n      // 检测二维码\n      axios.get('/api/qr/check')\n        .then(res => {\n          console.debug(res)\n          if (this.qrTimestamp < res.data.data.qr_time) {\n            this.qrTimestamp = res.data.data.qr_time\n            // 用这种方式更新 url ，只在 url 最后加入时间，这样 vue 就会认为图片改变了，就会重新获取，而服务器不处理这个时间即可。\n            this.qrUrl = '/api/qr?t=' + this.qrTimestamp\n            console.debug('更新QR')\n          }\n\n          let code = res.data.code\n          if (code === 200) {\n            //console.log('二维码获取到了')\n            this.qrStage = 2\n          } else if (code === 201) {\n            console.log('还没拿到QR继续等待')\n          } else if (code == 202) {\n            let wxcode = res.data.data.wechat_error_code\n            if (wxcode === 201) {\n              console.log('二维码被扫')\n              this.qrStage = 4\n            }\n            else if (wxcode === 400) {\n              console.log('二维码确认超时')\n              // this.checkQRTimerClose()\n              this.qrStage = 5\n            } else if (wxcode === 200) {\n              this.qrStage = 6\n              console.log('登陆成功')\n              this.checkQRTimerClose()\n            }\n            else if (wxcode === 408) {\n              console.log('二维码疑似失效')\n              this.qrStage = 2\n              //this.qrStage = 3\n            }\n            else {\n              this.qrError(res.data.msg + ' 状态码：' + res.data.data.wechat_error_code)\n            }\n          } else {\n            this.qrError(res.data.msg)\n          }\n        })\n        .catch(err => {\n          this.qrError(err.message)\n        })\n    },\n    checkQRTimer () {\n      this.checkQRTimerClose()\n      this.timerQR = setInterval(this.checkQR, 1000)\n    }\n    ,\n    checkQRTimerClose () {\n      if (this.timerQR) {\n        clearInterval(this.timerQR)\n      }\n      this.timerQR = null\n    }\n  },\n  created () {\n    this.login()\n  },\n  beforeDestroy () {\n    this.checkQRTimerClose()\n  }\n};\n</script>\n\n<style scoped>\n.image {\n  width: 100%;\n  display: block;\n}\n.text {\n  font-size: 14px;\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/common/QR.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"qr-root\"},[(_vm.qrStage === 0)?_c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.qrStage === 0),expression:\"qrStage === 0\"}],staticClass:\"qr-loading\",attrs:{\"element-loading-text\":\"正在请求微信登录二维码\",\"element-loading-spinner\":\"el-icon-loading\",\"element-loading-background\":\"rgba(0, 0, 0, 0.8)\"}}):(_vm.qrStage === 1)?_c('div',{staticClass:\"qr-error\"},[_c('p',{staticClass:\"text\"},[_vm._v(_vm._s(_vm.qrRequestMsg))]),_vm._v(\" \"),_c('ElButton',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.retry}},[_vm._v(\"重试\")])],1):_c('div',{staticClass:\"qr\"},[_c('ElRow',{attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('ElCol',{attrs:{\"span\":5}},[_c('ElCard',{attrs:{\"body-style\":{ padding : '0px'}}},[_c('img',{staticClass:\"image\",attrs:{\"src\":_vm.qrUrl}})]),_vm._v(\" \"),(_vm.qrStage === 2)?_c('p',[_vm._v(\"请扫描二维码登录\")]):(_vm.qrStage === 3)?_c('div',[_c('p',[_vm._v(\"二维码失效\")]),_vm._v(\" \"),_c('ElButton',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.retry}},[_vm._v(\"刷新\")])],1):(_vm.qrStage === 4)?_c('div',[_c('p',[_vm._v(\"请在APP上点击登陆\")])]):(_vm.qrStage === 5)?_c('div',[_c('p',[_vm._v(\"登陆超时\")]),_vm._v(\" \"),_c('ElButton',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.retry}},[_vm._v(\"刷新\")])],1):(_vm.qrStage === 6)?_c('div',[_c('p',[_vm._v(\"登陆成功\")])]):_vm._e()],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-5e75b682\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/common/QR.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5e75b682\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./QR.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./QR.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./QR.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5e75b682\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./QR.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5e75b682\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/common/QR.vue\n// module id = null\n// module chunks = ","<template>\n  <ElRow type=\"flex\" justify=\"center\">\n    <ElCol :span=\"12\">\n      <div style=\"margin: 20px 0;\"></div>\n      <ElInput v-model=\"username\" placeholder=\"用户名，可以是备注名\" type=\"text\"></ElInput>\n      <div style=\"margin: 20px 0;\"></div>\n      <ElInput v-model=\"message\" placeholder=\"信息\" type=\"textarea\" :autosize=\"{ minRows: 3}\"></ElInput>\n      <div style=\"margin: 20px 0;\"></div>\n\n      <!-- <p><span style=\"color:#2C3E50;font-family:Avenir, Helvetica, Arial, sans-serif;font-size:medium;\">通过&nbsp;</span><span style=\"font-family:Avenir, Helvetica, Arial, sans-serif;font-size:medium;color:orange;\"><span style=\"color:#337FE5;\">backend-ip:port</span>/send/<span style=\"color:#337FE5;\">{username}</span>/<span style=\"color:#337FE5;\">{message}</span></span><span style=\"color:#2C3E50;font-family:Avenir, Helvetica, Arial, sans-serif;font-size:medium;\">&nbsp;可直接发送消息</span></p>      \n      <div style=\"margin: 20px 0;\"></div> -->\n\n      <ElButton type=\"primary\" @click=\"send\">发送</ElButton>\n    </ElCol>\n  </ElRow>\n</template>\n\n<script>\nimport axios from 'axios'\n\nString.prototype.trim = function () {\n  return this.replace(/(^\\s*)|(\\s*$)/g, \"\");\n}\nfunction isEmpty (str) {\n  if (str == null || typeof str == \"undefined\" || str.trim() == \"\") {\n    return true;\n  }\n  else {\n    return false;\n  }\n}\n\nexport default {\n  data () {\n    return {\n      username: '',\n      message: ''\n    }\n  },\n  methods: {\n    send () {\n      if (isEmpty(this.username) || isEmpty(this.message)) {\n        this.$message({\n          message: '用户名和消息不得为空',\n          type: 'warning'\n        });\n        return\n      }\n\n      let body = {'username': this.username, 'message': this.message}\n\n      axios.post('/api/send', body)\n        .then(res => {\n          let code = res.data.code\n          if (code === 200) {\n            this.$message({\n              message: '发送成功',\n              type: 'success'\n            });\n            this.message = ''\n          } else {\n            this.$message({\n              message: res.data.msg,\n              type: 'error'\n            });\n          }\n        })\n        .catch(err => {\n          this.$message({\n            message: err.message,\n            type: 'error'\n          });\n        })\n    }\n  },\n\n}\n</script>\n\n<style scoped>\n.el-row {\n  margin-bottom: 20px;\n}\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/common/SendMessage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ElRow',{attrs:{\"type\":\"flex\",\"justify\":\"center\"}},[_c('ElCol',{attrs:{\"span\":12}},[_c('div',{staticStyle:{\"margin\":\"20px 0\"}}),_vm._v(\" \"),_c('ElInput',{attrs:{\"placeholder\":\"用户名，可以是备注名\",\"type\":\"text\"},model:{value:(_vm.username),callback:function ($$v) {_vm.username=$$v},expression:\"username\"}}),_vm._v(\" \"),_c('div',{staticStyle:{\"margin\":\"20px 0\"}}),_vm._v(\" \"),_c('ElInput',{attrs:{\"placeholder\":\"信息\",\"type\":\"textarea\",\"autosize\":{ minRows: 3}},model:{value:(_vm.message),callback:function ($$v) {_vm.message=$$v},expression:\"message\"}}),_vm._v(\" \"),_c('div',{staticStyle:{\"margin\":\"20px 0\"}}),_vm._v(\" \"),_c('ElButton',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.send}},[_vm._v(\"发送\")])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-90b55d9a\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/common/SendMessage.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-90b55d9a\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./SendMessage.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./SendMessage.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./SendMessage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-90b55d9a\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./SendMessage.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-90b55d9a\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/common/SendMessage.vue\n// module id = null\n// module chunks = ","<template>\n  <div class=\"login\">\n    <div v-if=\"loginState === 0\">\n      <p>正在获取登录状态</p>\n    </div>\n    <div v-else-if=\"loginState === 1\">\n      <p>获取登录状态错误</p>\n      <p>{{msg}}</p>\n      <ElButton type=\"primary\"\n                @click=\"retryLoginCheck\">重试</ElButton>\n    </div>\n    <div v-else-if=\"loginState === 2\">\n      <p>已经登录</p>\n      <ElButton type=\"primary\"\n                @click=\"logout\">退出登录</ElButton>\n      <SendMessage></SendMessage>\n    </div>\n    <div v-else-if=\"loginState === 3\">\n      <ElButton v-show=\"!showQR\" type=\"primary\" @click=\"login\">登录</ElButton>\n      <QR v-if=\"showQR\"></QR>\n    </div>\n  </div>\n</template>\n\n<script>\nimport QR from \"@/components/common/QR.vue\";\nimport SendMessage from \"@/components/common/SendMessage\"\nimport axios from 'axios'\n\nvar LoginState = {\n  CHECK: 0,\n  CHECK_FAILED: 1,\n  ONLINE: 2,\n  OFFLINE: 3\n}\n\nexport default {\n  components: {\n    QR,SendMessage\n  },\n  data () {\n    return {\n      // 0 正在检测 1 检测错误 2 已登录 3 未登录\n      loginState: LoginState.CHECK,\n      msg: '',\n      timerLogin: null,\n      showQR: false\n    };\n  },\n  created () {\n    this.checkLoginTimer()\n  },\n  methods: {\n    login () {\n      this.showQR = true\n    },\n    loginCheck () {\n      axios.get('/api/login/check')\n        .then(res => {\n          let state = res.data.data.login ? LoginState.ONLINE : LoginState.OFFLINE\n\n          // 如果之前的状态不是离线, 新的状态是离线，则切换 QR 组件，当用户点击登录时，通过 v-if 重新执行 QR 组件的登录逻辑\n          if (this.loginState != LoginState.OFFLINE && state === LoginState.OFFLINE) {\n            this.showQR = false\n          }\n\n          this.loginState = state\n          console.debug('CheckLogin oldState = ' + this.loginState + ' newState = ' + state)\n        })\n        .catch(err => {\n          this.msg = err.message\n          this.loginState = LoginState.CHECK_FAILED\n          this.checkLoginTimerClose()\n          console.error(err);\n        })\n    },\n    logout () {\n      axios.post('/api/logout')\n        .then(res => {\n          console.log(res)\n        })\n        .catch(err => {\n          console.error(err);\n        })\n    },\n    retryLoginCheck () {\n      this.checkLoginTimer()\n    },\n    checkLoginTimer () {\n      this.loginState = LoginState.CHECK\n      this.checkLoginTimerClose()\n      this.timerLogin = setInterval(this.loginCheck, 1000)\n    }\n    ,\n    checkLoginTimerClose () {\n      if (this.timerLogin) {\n        clearInterval(this.timerLogin)\n      }\n      this.timerLogin = null\n    }\n  },\n  beforeDestroy () {\n    this.checkLoginTimerClose()\n  }\n};\n</script>\n\n<style scoped>\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/page/Login.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[(_vm.loginState === 0)?_c('div',[_c('p',[_vm._v(\"正在获取登录状态\")])]):(_vm.loginState === 1)?_c('div',[_c('p',[_vm._v(\"获取登录状态错误\")]),_vm._v(\" \"),_c('p',[_vm._v(_vm._s(_vm.msg))]),_vm._v(\" \"),_c('ElButton',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.retryLoginCheck}},[_vm._v(\"重试\")])],1):(_vm.loginState === 2)?_c('div',[_c('p',[_vm._v(\"已经登录\")]),_vm._v(\" \"),_c('ElButton',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.logout}},[_vm._v(\"退出登录\")]),_vm._v(\" \"),_c('SendMessage')],1):(_vm.loginState === 3)?_c('div',[_c('ElButton',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.showQR),expression:\"!showQR\"}],attrs:{\"type\":\"primary\"},on:{\"click\":_vm.login}},[_vm._v(\"登录\")]),_vm._v(\" \"),(_vm.showQR)?_c('QR'):_vm._e()],1):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-50320c4c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/page/Login.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-50320c4c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./Login.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./Login.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./Login.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-50320c4c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./Login.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-50320c4c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/page/Login.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Login from '@/components/page/Login'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'Home',\n      redirect: '/login'\n    },\n    {\n      path: '/login',\n      name: 'Login',\n      component: Login\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport router from './router'\nimport ElementUI from 'element-ui'\nimport 'element-ui/lib/theme-chalk/index.css'\nimport axios from 'axios'\n\nVue.prototype.$axios = axios\n\nVue.config.productionTip = false\n\nVue.use(ElementUI)\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  router,\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}